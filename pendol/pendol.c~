#include <stdio.h>
#include <stdlib.h>
#include <math.h>

//RODARI RIVA
//5 ottobre 2017   -   v.0.0.9

struct vector{
  double a;
  double va;
};

double energy(double x, double v, double omega2);               

int main(int argc, char *argv[]){
  
  long int i, steps;                                             
  double omega2, gamma, f0, omegaf, dt, tmax, e, e0;
  
  struct vector state;
  
  FILE *table;
  
  if(argc != 9){
    printf("Usage: a va omega2 dt tmax gamma f0 omegaf\n");
    exit(EXIT_FAILURE);
  }
  
  

  state.a = atof(argv[1]);        //Raccolgo le informazioni da linea di comando con la f atof()
  state.va = atof(argv[2]);
  omega2 = atof(argv[3]);
  dt = atof(argv[4]);
  tmax = atof(argv[5]);
  gamma = atof(argv[6]);
  f0 = atof(argv[7]);
  omegaf = atof(argv[8]);


  e0 = energy(x, v, omega2);
  
  steps = (long int)(tmax/dt);   
  

  while(choice != 0 && choice != 1){           
    printf("Insert (0) for Euler, (1) for Euler-Cromer: ");
    scanf("%d", &choice);
  }



  if(choice == 0){             
    table = fopen("o_euler.txt", "w");          

    fprintf(table, "# Structure: t,\t x_calc,\t v_calc,\t E(t)/E0 - 1\n");
    fprintf(table, "\t\t%lf\t %lf\t %lf\t %lf\n", 0., x, v, 0.);    
 
    for (i=0; i<steps; i++){
      eulero(&x, &v, dt, omega2);
      e = energy(x, v, omega2);
      fprintf(table, "\t\t%lf\t %lf\t %lf\t %lf\n", dt*(i+1), x, v, e/e0 - 1.);
    }
  }  


  else{
    table = fopen("o_cromer.txt", "w");           
  
    fprintf(table, "# Structure: t,\t x_calc,\t v_calc,\t E(t)/E0 - 1\n");
    fprintf(table, "\t\t%lf\t %lf\t %lf\t %lf\n", 0., x, v, 0.);     
  
    for (i=0; i<steps; i++){    
      cromer(&x, &v, dt, omega2);
      e = energy(x, v, omega2);
      fprintf(table, "\t\t%lf\t %lf\t %lf\t %lf\n", dt*(i+1), x, v, e/e0 - 1.);
    }
  }

  fclose(table);             

  exit(0);
}

double energy(double x, double v, double omega2) {            //Funzione Energia Meccanica

  return ;

}
